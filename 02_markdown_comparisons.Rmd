---
title: "NC-09 precinct-level comparisons"
author: "Aaron Kessler"
date: "9/11/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
library(janitor)
library(lubridate)
library(reshape2)
library(writexl)
library(kableExtra)
# library(gt)
options(scipen = 999)


joined <- readRDS("processed_data/joined.rds")

robeson <- joined %>% 
  filter(county == "ROBESON")




```


### Breakdowns by Flips


Total flipped precincts on Tues night
```{r echo=FALSE}

joined %>% 
  count(flip) %>% 
  kable() %>% 
  kable_styling(bootstrap_options = c("striped", "condensed"), 
                full_width = F,
                position = "left")

```


Looking by party, Republicans owned the night for flips 
```{r echo=FALSE}

joined %>% 
  filter(flip == "Y") %>% 
  count(flip, winner19) %>% 
  arrange(desc(n)) %>% 
  kable() %>% 
  kable_styling(bootstrap_options = c("striped", "condensed"), 
                full_width = F,
                position = "left")

```



Which counties had most flips by party?
Republicans flipped a huge chunk (15!) in **Robeson County**
```{r echo=FALSE}

joined %>% 
  filter(flip == "Y") %>% 
  count(flip, winner19, county) %>% 
  arrange(desc(winner19), desc(n)) %>% 
  kable() %>% 
  kable_styling(bootstrap_options = c("striped", "condensed"), 
                full_width = F,
                position = "left")

```



### Diving into Robeson County

Robeson County flips were entirely Republican
```{r echo=FALSE}

robeson %>% 
  filter(flip == "Y") %>% 
  count(flip, winner19) %>% 
  kable() %>% 
  kable_styling(bootstrap_options = c("striped", "condensed"), 
                full_width = F,
                position = "left")

```


Democrats lost vote share in nearly every Robeson precinct compared with 2018.
The table below shows the number of precincts the Dem share went up or down.
```{r echo=FALSE}

robeson %>% 
  count(dem_updown) %>% 
  kable() %>% 
  kable_styling(bootstrap_options = c("striped", "condensed"), 
                full_width = F,
                position = "left")

```


The net loss in votes for Democrats from November was more than 4,000
```{r echo=FALSE}

robeson %>% 
  summarise(sum(votespread_GAINdiff_dem)) %>% 
  kable() %>% 
  kable_styling(bootstrap_options = c("striped", "condensed"), 
                full_width = F,
                position = "left")

```



And in fact 33 is also the number of precincts Democrats carried in 2018. This time? Not so much.

```{r echo=FALSE}

robeson %>% 
  count(winner18) %>% 
  kable() %>%
  kable_styling(bootstrap_options = c("striped", "condensed"),
                full_width = F,
                position = "left")

robeson %>% 
  count(winner19) %>% 
  kable() %>%
  kable_styling(bootstrap_options = c("striped", "condensed"),
                full_width = F,
                position = "left")



```

Here's what that looks like in terms of number of votes in those precincts - 2018 compared to 2019
```{r echo=FALSE}

robeson %>% 
  group_by(winner18) %>% 
  summarise(n(), demvotes = sum(dem18), gopvotes = sum(gop18)) %>% 
  mutate(
    difference = demvotes - gopvotes
  ) %>% 
  kable() %>%
  kable_styling(bootstrap_options = c("striped", "condensed"),
                full_width = F,
                position = "left")



robeson %>% 
  group_by(winner19) %>% 
  summarise(n(), demvotes = sum(dem19), gopvotes = sum(gop19)) %>% 
  mutate(
    difference = demvotes - gopvotes
  ) %>% 
  kable() %>%
  kable_styling(bootstrap_options = c("striped", "condensed"),
                full_width = F,
                position = "left")


```


Democrats only had five precincts in Robeson with higher vote percentages than in November - and even those were low single digits.

By contrast, the losses were big and widespread. In 11 precincts, Democrats had double-digit losses in pct points compared with 2018 -- representing a loss of more than 2,000 votes since the midterms. (All but one of those precincts flipped from blue to red.)
```{r echo=FALSE}

robeson %>% 
  select(county, precinct, dem_change, dem_vote_change, flip) %>% 
  arrange(dem_change) %>% 
  head(11) %>% 
  kable() %>%
  kable_styling(bootstrap_options = c("striped", "condensed"),
                full_width = F,
                position = "left") %>% 
  column_spec(3, bold = T)




```

Biggest Republican wins in Robeson, and point growth from last time
```{r echo=FALSE}

robeson %>% 
  select(county, precinct, gop18pct, gop19pct) %>% 
  arrange(desc(gop19pct)) %>% 
  mutate(
    point_boost = gop19pct - gop18pct
  ) %>% 
  head(10) %>%
  kable() %>%
  kable_styling(bootstrap_options = c("striped", "condensed"),
                full_width = F,
                position = "left") %>%
  column_spec(4, bold = T)

```


### Did each party's pct of vote go up or down since Nov?

Democratic
```{r echo=FALSE}

joined %>% 
  count(dem_updown) %>% 
  arrange(desc(n)) %>% 
  kable() %>% 
  kable_styling(bootstrap_options = c("striped", "condensed"), 
                full_width = F,
                position = "left")

```


Republican
```{r echo=FALSE}

joined %>% 
  count(gop_updown) %>% 
  arrange(desc(n)) %>% 
  kable() %>% 
  kable_styling(bootstrap_options = c("striped", "condensed"), 
                full_width = F,
                position = "left")

```


Where did Democratic percent of the vote fall from Nov
```{r echo=FALSE}

joined %>% 
  count(dem_updown, county) %>% 
  filter(dem_updown == "down") %>% 
  arrange(desc(n)) %>% 
  kable() %>% 
  kable_styling(bootstrap_options = c("striped", "condensed"), 
                full_width = F,
                position = "left")

```

Where did Republican percent of the vote fall from Nov
```{r echo=FALSE}

joined %>% 
  count(gop_updown, county) %>% 
  filter(gop_updown == "down") %>% 
  arrange(desc(n)) %>% 
  kable() %>% 
  kable_styling(bootstrap_options = c("striped", "condensed"), 
                full_width = F,
                position = "left")

```





### Vote-Spread Metrics


Where did Democrats *lose* the most in the vote number difference compared with Nov?
It's all about Robeson County.
```{r echo=FALSE}

joined %>% 
  select(county, precinct, votespread_18_dem, votespread_19_dem, votespread_GAINdiff_dem) %>% 
  arrange(votespread_GAINdiff_dem) %>% 
  filter(votespread_19_dem < 0) %>% 
  head(10) %>% 
  kable() %>% 
  kable_styling(bootstrap_options = c("striped", "condensed"), 
                full_width = F,
                position = "left") %>% 
  column_spec(5, bold = T)

```



In areas where Democrats gained votes from Nov, where did they *gain* the most in vote number spread?
```{r echo=FALSE}

joined %>% 
  select(county, precinct, votespread_18_dem, votespread_19_dem, votespread_GAINdiff_dem) %>% 
  arrange(desc(votespread_GAINdiff_dem)) %>% 
  filter(votespread_19_dem > 0) %>% 
  head(10) %>% 
  kable() %>% 
  kable_styling(bootstrap_options = c("striped", "condensed"), 
                full_width = F,
                position = "left") %>% 
  column_spec(5, bold = T)

```


