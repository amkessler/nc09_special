---
title: "NC-09 precinct-level comparisons"
author: "Aaron Kessler"
date: "9/11/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
library(janitor)
library(lubridate)
library(reshape2)
library(writexl)
library(kableExtra)
library(gt)
options(scipen = 999)


joined <- readRDS("processed_data/joined.rds")

robeson <- joined %>% 
  filter(county == "ROBESON")




```


### Breakdowns by Flips


Total flipped precincts on Tues night
```{r echo=FALSE}

joined %>% 
  count(flip) %>% 
  kable() %>% 
  kable_styling(bootstrap_options = c("striped", "condensed"), 
                full_width = F,
                position = "left")

```


Looking by party, Republicans owned the night for flips 
```{r echo=FALSE}

joined %>% 
  filter(flip == "Y") %>% 
  count(flip, winner19) %>% 
  arrange(desc(n)) %>% 
  kable() %>% 
  kable_styling(bootstrap_options = c("striped", "condensed"), 
                full_width = F,
                position = "left")

```



Which counties had most flips by party?
Republicans flipped a huge chunk (15!) in **Robeson County**
```{r echo=FALSE}

joined %>% 
  filter(flip == "Y") %>% 
  count(flip, winner19, county) %>% 
  arrange(desc(winner19), desc(n)) %>% 
  kable() %>% 
  kable_styling(bootstrap_options = c("striped", "condensed"), 
                full_width = F,
                position = "left")

```



### Did each party's pct of vote go up or down since Nov?

Democratic
```{r echo=FALSE}

joined %>% 
  count(dem_updown) %>% 
  arrange(desc(n)) %>% 
  kable() %>% 
  kable_styling(bootstrap_options = c("striped", "condensed"), 
                full_width = F,
                position = "left")

```


Republican
```{r echo=FALSE}

joined %>% 
  count(gop_updown) %>% 
  arrange(desc(n)) %>% 
  kable() %>% 
  kable_styling(bootstrap_options = c("striped", "condensed"), 
                full_width = F,
                position = "left")

```


Where did Democratic percent of the vote fall from Nov
```{r echo=FALSE}

joined %>% 
  count(dem_updown, county) %>% 
  filter(dem_updown == "down") %>% 
  arrange(desc(n)) %>% 
  kable() %>% 
  kable_styling(bootstrap_options = c("striped", "condensed"), 
                full_width = F,
                position = "left")

```

Where did Republican percent of the vote fall from Nov
```{r echo=FALSE}

joined %>% 
  count(gop_updown, county) %>% 
  filter(gop_updown == "down") %>% 
  arrange(desc(n)) %>% 
  kable() %>% 
  kable_styling(bootstrap_options = c("striped", "condensed"), 
                full_width = F,
                position = "left")

```





### Vote-Spread Metrics


Where did Democrats *lose* the most in the vote number difference compared with Nov?
It's all about Robeson County.
```{r echo=FALSE}

joined %>% 
  select(county, precinct, votespread_18_dem, votespread_19_dem, votespread_GAINdiff_dem) %>% 
  arrange(votespread_GAINdiff_dem) %>% 
  filter(votespread_19_dem < 0) %>% 
  head(10) %>% 
  kable() %>% 
  kable_styling(bootstrap_options = c("striped", "condensed"), 
                full_width = F,
                position = "left") %>% 
  column_spec(5, bold = T)

```



In areas where Democrats gained votes from Nov, where did they *gain* the most in vote number spread?
```{r echo=FALSE}

joined %>% 
  select(county, precinct, votespread_18_dem, votespread_19_dem, votespread_GAINdiff_dem) %>% 
  arrange(desc(votespread_GAINdiff_dem)) %>% 
  filter(votespread_19_dem > 0) %>% 
  head(10) %>% 
  kable() %>% 
  kable_styling(bootstrap_options = c("striped", "condensed"), 
                full_width = F,
                position = "left") %>% 
  column_spec(5, bold = T)

```



## Diving into Robeson County


### asdfasdf

Robeson County flips were entirely Republican
```{r echo=FALSE}

robeson %>% 
  filter(flip == "Y") %>% 
  count(flip, winner19) %>% 
  kable() %>% 
  kable_styling(bootstrap_options = c("striped", "condensed"), 
                full_width = F,
                position = "left")

```


Democrats lost vote share in nearly every Robeson precinct compared with 2018 
```{r echo=FALSE}

robeson %>% 
  count(dem_updown) %>% 
  kable() %>% 
  kable_styling(bootstrap_options = c("striped", "condensed"), 
                full_width = F,
                position = "left")

```

